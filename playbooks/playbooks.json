{
  "type":"workflow_collections",
  "data":[
     {
        "@type":"WorkflowCollection",
        "name":"Sample - AlienVault USM Anywhere - 1.2.0",
        "description":"Sample playbooks for \"AlienVault USM Anywhere\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
        "visible":true,
        "image":"/api/3/images/0fec21d6-844b-4e16-b32b-11d0bfda7bff",
        "uuid":"e4de8e4a-9836-49d9-91a1-c67b8a59f367",
        "id":125,
        "createUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
        "createDate":1633027730,
        "modifyUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
        "modifyDate":1648747420,
        "recordTags":[
           
        ],
        "workflows":[
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"Alarm: Get Alarms",
              "aliasName":null,
              "tag":"#Alienvault USM Anywhere",
              "description":"Get list of alarms from usm server",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1625828097,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/02aec952-e0d2-4660-902f-ca9aed5a908c",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Alerts",
                    "description":null,
                    "arguments":{
                       "route":"934938dc-c999-49b4-bdd0-93360ce1e804",
                       "title":"Alienvault USM Anywhere: Get Alarms",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[
                          
                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.input.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":true,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"20",
                    "left":"20",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"02aec952-e0d2-4660-902f-ca9aed5a908c",
                    "id":7420
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Get Alarms",
                    "description":null,
                    "arguments":{
                       "name":"Alienvault USM Anywhere",
                       "config":"52b04e16-3d4d-49ae-b818-ebe435541a51",
                       "params":{
                          "page":"",
                          "size":"",
                          "sort":"",
                          "status":"In Review",
                          "sort_order":"",
                          "suppressed":false,
                          "rule_intent":"",
                          "rule_method":"",
                          "rule_strategy":"",
                          "priority_label":"",
                          "alarm_sensor_sources":"",
                          "timestamp_occured_gte":"",
                          "timestamp_occured_lte":""
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_alarms",
                       "operationTitle":"Get Alarms",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"120",
                    "left":"180",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"77aa0e81-c66b-4f59-b1ab-58006b31efef",
                    "id":7421
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Alerts -> Get Alarms",
                    "targetStep":"/api/3/workflow_steps/77aa0e81-c66b-4f59-b1ab-58006b31efef",
                    "sourceStep":"/api/3/workflow_steps/02aec952-e0d2-4660-902f-ca9aed5a908c",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"c702d3c0-cfe9-43c1-9f28-b30e94c72805"
                 }
              ],
              "priority":null,
              "uuid":"14d2bd23-ae3b-43b5-a12a-418601e344b2",
              "recordTags":[
                 "alienvault-usm-anywhere",
                 "AlienVault"
              ],
              "id":1499,
              "createUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "createDate":1633027730,
              "modifyUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "modifyDate":1633027730,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"Alarm: Delete Alarm Label",
              "aliasName":null,
              "tag":"#Alienvault USM Anywhere",
              "description":"Delete label from input alarm",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1625827399,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/c9767109-d056-4d95-aac2-ece99103c3b5",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Start",
                    "description":null,
                    "arguments":{
                       "route":"c2daaf3d-4ae0-49ad-ba60-e28d75a0cf1a",
                       "title":"Alienvault USM Anywhere: Delete Alarm Label",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[
                          
                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.input.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":true,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"20",
                    "left":"20",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"c9767109-d056-4d95-aac2-ece99103c3b5",
                    "id":7422
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Delete Alarm Label",
                    "description":null,
                    "arguments":{
                       "name":"Alienvault USM Anywhere",
                       "config":"3706c9f3-13a8-4d5c-990a-efc2433b213f",
                       "params":{
                          "alarmId":"aa274c77-f573-9903-1db5-230b429af083",
                          "labelId":"2c90c544-9757-4473-adae-c767ddd670e0"
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"delete_alarm_label",
                       "operationTitle":"Delete Alarm Label",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"112",
                    "left":"187",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"ebe6eb4a-a201-4808-982e-c26eec9ace10",
                    "id":7423
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Start -> Delete Alarm Label",
                    "targetStep":"/api/3/workflow_steps/ebe6eb4a-a201-4808-982e-c26eec9ace10",
                    "sourceStep":"/api/3/workflow_steps/c9767109-d056-4d95-aac2-ece99103c3b5",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"7b8d33e2-cdc4-47c3-a25d-25d029bd8186"
                 }
              ],
              "priority":null,
              "uuid":"55f14630-5249-4976-a3f6-51df80605811",
              "recordTags":[
                 "alienvault-usm-anywhere",
                 "AlienVault"
              ],
              "id":1500,
              "createUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "createDate":1633027730,
              "modifyUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "modifyDate":1633027730,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"Alarm: Get Alarm Labels",
              "aliasName":null,
              "tag":"#Alienvault USM Anywhere",
              "description":"List label ids for an alarm",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1625827944,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/0859d68c-cac8-4cc4-b78f-ec94cd45e0b7",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Alerts",
                    "description":null,
                    "arguments":{
                       "route":"d5b4cf49-e8fa-428a-aedb-3b540c483ed8",
                       "title":"Alienvault USM Anywhere: Get Alarm Labels",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[
                          
                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.input.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":true,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"20",
                    "left":"20",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"0859d68c-cac8-4cc4-b78f-ec94cd45e0b7",
                    "id":7424
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Get Alarm Labels",
                    "description":null,
                    "arguments":{
                       "name":"Alienvault USM Anywhere",
                       "config":"52b04e16-3d4d-49ae-b818-ebe435541a51",
                       "params":{
                          "alarmId":"1708bd82-30f3-1a24-d395-4cf5ca213a97"
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_alarm_labels",
                       "operationTitle":"Get Alarm Labels",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"140",
                    "left":"94",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"88d335f0-65bb-4356-ada7-415080d68046",
                    "id":7425
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Alerts -> Get Alarm Labels",
                    "targetStep":"/api/3/workflow_steps/88d335f0-65bb-4356-ada7-415080d68046",
                    "sourceStep":"/api/3/workflow_steps/0859d68c-cac8-4cc4-b78f-ec94cd45e0b7",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"b629b011-78c5-4f2f-8f69-2df6a3d7f20b"
                 }
              ],
              "priority":null,
              "uuid":"6cd108bd-bf38-4acb-a698-9c258609042d",
              "recordTags":[
                 "alienvault-usm-anywhere",
                 "AlienVault"
              ],
              "id":1501,
              "createUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "createDate":1633027730,
              "modifyUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "modifyDate":1633027730,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":">>AlienVaultUSM > Init Macros",
              "aliasName":null,
              "tag":"#alienvault-usm-anywhere #dataingestion",
              "description":"This playbook create AlienVaultUSM macros if not exist.",
              "isActive":true,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 "AlienVaultUSMMacroName",
                 "AlienVaultUSMMacroValue",
                 "overrideIfNoMatch"
              ],
              "synchronous":false,
              "lastModifyDate":1648652593,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/b6244aa9-6f1e-4b63-8339-7b2b6b3fc9fe",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Fetch Macro Current Value",
                    "description":null,
                    "arguments":{
                       "ASDasd":"{{vars.AlienVaultUSMMacroName}}",
                       "macroExistingRecord":"{{vars.steps.Get_AlienVaultUSM_Macros.data['hydra:member'][0]}}"
                    },
                    "status":null,
                    "top":"435",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"136da9ed-b64e-4cd0-9463-89b7cb9a7c02",
                    "id":15694
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Get AlienVaultUSM Macros",
                    "description":null,
                    "arguments":{
                       "params":{
                          "iri":"/api/wf/api/dynamic-variable/?format=json&name={{vars.AlienVaultUSMMacroName}}",
                          "body":"",
                          "method":"GET"
                       },
                       "version":"3.1.2",
                       "connector":"cyops_utilities",
                       "operation":"make_cyops_request",
                       "operationTitle":"FSR: Make FortiSOAR API Call",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"165",
                    "left":"300",
                    "stepType":"/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                    "uuid":"15837f5f-6862-4b95-95d7-966074746ecf",
                    "id":15691
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Update Marco If Required",
                    "description":null,
                    "arguments":{
                       "when":"{{(vars.overrideIfNoMatch  == true) and (vars.macroExistingRecord.value != vars.AlienVaultUSMMacroValue)}}",
                       "params":{
                          "iri":"/api/wf/api/dynamic-variable/{{ vars.macroExistingRecord.id }}/",
                          "body":"{ 'name': '{{vars.AlienVaultUSMMacroName}}'   , 'value': '{{vars.AlienVaultUSMMacroValue}}' }",
                          "method":"PUT"
                       },
                       "version":"3.0.4",
                       "connector":"cyops_utilities",
                       "operation":"make_cyops_request",
                       "operationTitle":"FSR: Make FortiSOAR API Call",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"570",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                    "uuid":"24a4cea5-6d96-4394-a0b0-ef01e70d1a66",
                    "id":15693
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"AlienVaultUSM Macro Exists",
                    "description":null,
                    "arguments":{
                       "conditions":[
                          {
                             "option":"Not Exist",
                             "step_iri":"/api/3/workflow_steps/4ec5f4f5-548d-48a8-a5e4-dc0fb3de56fd",
                             "condition":"{{ vars.steps.Get_AlienVaultUSM_Macros.data['hydra:totalItems']==0 }}",
                             "step_name":"Create AlienVaultUSM Macro"
                          },
                          {
                             "option":"Exist",
                             "default":true,
                             "step_iri":"/api/3/workflow_steps/136da9ed-b64e-4cd0-9463-89b7cb9a7c02",
                             "step_name":"Fetch Macro Current Value"
                          }
                       ]
                    },
                    "status":null,
                    "top":"300",
                    "left":"300",
                    "stepType":"/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
                    "uuid":"28e9cf3b-9c3c-4eba-9f14-65b11a52ff06",
                    "id":15692
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Create AlienVaultUSM Macro",
                    "description":null,
                    "arguments":{
                       "params":{
                          "iri":"/api/wf/api/dynamic-variable/?format=json",
                          "body":"{ 'name': '{{vars.AlienVaultUSMMacroName}}'   , 'value': '{{vars.AlienVaultUSMMacroValue}}' }",
                          "method":"POST"
                       },
                       "version":"3.0.4",
                       "connector":"cyops_utilities",
                       "operation":"make_cyops_request",
                       "operationTitle":"FSR: Make FortiSOAR API Call",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"435",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                    "uuid":"4ec5f4f5-548d-48a8-a5e4-dc0fb3de56fd",
                    "id":15689
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Start",
                    "description":null,
                    "arguments":{
                       "step_variables":{
                          "input":{
                             "params":[
                                
                             ]
                          }
                       }
                    },
                    "status":null,
                    "top":"30",
                    "left":"300",
                    "stepType":"/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                    "uuid":"b6244aa9-6f1e-4b63-8339-7b2b6b3fc9fe",
                    "id":15690
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"AlienVaultUSM Macro Exists -> Fetch Macro Current Value",
                    "targetStep":"/api/3/workflow_steps/136da9ed-b64e-4cd0-9463-89b7cb9a7c02",
                    "sourceStep":"/api/3/workflow_steps/28e9cf3b-9c3c-4eba-9f14-65b11a52ff06",
                    "label":"Exist",
                    "isExecuted":false,
                    "uuid":"d323355c-cc3c-4f38-8d7b-c5a33a629386"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Fetch Macro Current Value -> Update Marco If Required",
                    "targetStep":"/api/3/workflow_steps/24a4cea5-6d96-4394-a0b0-ef01e70d1a66",
                    "sourceStep":"/api/3/workflow_steps/136da9ed-b64e-4cd0-9463-89b7cb9a7c02",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"b596857f-1e49-4b76-8ae4-bb4c7913e486"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Start -> Get AlienVaultUSM Macros",
                    "targetStep":"/api/3/workflow_steps/15837f5f-6862-4b95-95d7-966074746ecf",
                    "sourceStep":"/api/3/workflow_steps/b6244aa9-6f1e-4b63-8339-7b2b6b3fc9fe",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"e2331f3b-f780-4ac1-8b9f-4c1f7bdf2863"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Get AlienVaultUSM Macros -> AlienVaultUSM Macro Exists",
                    "targetStep":"/api/3/workflow_steps/28e9cf3b-9c3c-4eba-9f14-65b11a52ff06",
                    "sourceStep":"/api/3/workflow_steps/15837f5f-6862-4b95-95d7-966074746ecf",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"537d6dd6-da55-4c58-b0e5-2956f4b38bf4"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"AlienVaultUSM Macro Exists -> Create AlienVaultUSM Macro",
                    "targetStep":"/api/3/workflow_steps/4ec5f4f5-548d-48a8-a5e4-dc0fb3de56fd",
                    "sourceStep":"/api/3/workflow_steps/28e9cf3b-9c3c-4eba-9f14-65b11a52ff06",
                    "label":"Not Exist",
                    "isExecuted":false,
                    "uuid":"acf5f874-80f1-4440-9c51-2afa8d85d079"
                 }
              ],
              "priority":"/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
              "uuid":"9e8b51cf-1b7b-40df-aa9d-daa51aad90f7",
              "recordTags":[
                 "dataingestion",
                 "alienvault-usm-anywhere"
              ],
              "id":2970,
              "createUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "createDate":1648642383,
              "modifyUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "modifyDate":1648719913,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"> AlienVaultUSM > Fetch",
              "aliasName":null,
              "tag":"#alienvault-usm-anywhere #fetch #dataingestion",
              "description":"This playbook fetch the open incidents.",
              "isActive":true,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1648747299,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/6014bcde-0df4-4be4-998c-8637078640be",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Set Time Configuration",
                    "description":null,
                    "arguments":{
                       "curr_timestamp":"{{ arrow.utcnow().format('YYYY-MM-DDTHH:mm:ss.ssss')\n}}Z",
                       "last_pull_time":"{%if macro.AlienVaultUSMLastAlertPullTime == '0' or vars.request.env_setup %}{%if not vars.minutes or vars.minutes == ''%}0{% else %}{{((arrow.utcnow().shift(minutes=-vars.minutes)).format('YYYY-MM-DDTHH:mm:ss.ssss'))}}Z{% endif %}{% else %}{{macro.AlienVaultUSMLastAlertPullTime}}{% endif %}"
                    },
                    "status":null,
                    "top":"435",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"04e8bafe-3fe2-432d-a1f2-1be2f820e4b3",
                    "id":15677
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Configuration",
                    "description":null,
                    "arguments":{
                       "search":"",
                       "is_mssp":false,
                       "minutes":"10",
                       "page_size":"100",
                       "pages_array":"[]",
                       "tenant_mapping":"{\n  \"Super\": \"tenant1\",\n  \"usm-anywhere_customer1\": \"fortisoar_customer1\"\n}"
                    },
                    "status":null,
                    "top":"165",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"1bf00642-e024-477a-bf95-b4c7cbf298db",
                    "id":15683
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Environment Setup",
                    "description":null,
                    "arguments":{
                       "when":"{{vars.request.env_setup}}",
                       "arguments":{
                          "overrideIfNoMatch":"false",
                          "AlienVaultUSMMacroName":"AlienVaultUSMLastAlertPullTime",
                          "AlienVaultUSMMacroValue":"0"
                       },
                       "apply_async":false,
                       "step_variables":[
                          
                       ],
                       "workflowReference":"/api/3/workflows/9e8b51cf-1b7b-40df-aa9d-daa51aad90f7"
                    },
                    "status":null,
                    "top":"300",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
                    "uuid":"4b329261-8a0d-4a1a-b98e-9e07aaf62948",
                    "id":15682
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Start",
                    "description":null,
                    "arguments":{
                       "step_variables":{
                          "input":{
                             "params":[
                                
                             ]
                          },
                          "useMockOutput":"false",
                          "_configuration_schema":"[\n   {\n      \"title\":\"Status\",\n      \"tooltip\":\"The status of the alarm\",\n      \"description\":\"Status of the alarm based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"select\",\n      \"options\":[\n         \"Open\",\n         \"Closed\",\n         \"In Review\"\n      ],\n      \"name\":\"status\",\n      \"value\":\"Open\"\n   },\n   {\n      \"title\":\"Suppressed\",\n      \"tooltip\":\"Filter alarms by the suppressed flag\",\n      \"description\":\"Select this checkbox, i.e., set it to True, to filter alarms retrieved from the AlienVault USM Anywhere server by the suppressed flag.By default, this is set as False.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"checkbox\",\n      \"name\":\"suppressed\",\n      \"value\":false\n   },\n   {\n      \"title\":\"Rule Intent\",\n      \"tooltip\":\"The intent of the rule that triggered the alarm\",\n      \"description\":\"Intent of the rule that triggered the alarm, based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"rule_intent\",\n      \"placeholder\":\"Environmental Awareness\"\n   },\n   {\n      \"title\":\"Rule Method\",\n      \"tooltip\":\"The method of the rule that triggered the alarm\",\n      \"description\":\"Method of the rule that triggered the alarm, based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"rule_method\",\n      \"placeholder\":\"AWS EC2 Security Group Modified\"\n   },\n   {\n      \"title\":\"Rule Strategy\",\n      \"tooltip\":\"The strategy of the rule that triggered the alarm\",\n      \"description\":\"Strategy of the rule that triggered the alarm, based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"rule_strategy\",\n      \"placeholder\":\"Network Access Control Modification\"\n   },\n   {\n      \"title\":\"Priority Label\",\n      \"tooltip\":\"The priority of the alarm\",\n      \"description\":\"Priority of the alarm based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"priority_label\",\n      \"placeholder\":\"medium\"\n   },\n   {\n      \"title\":\"Alarm Sensor Sources\",\n      \"tooltip\":\"The uuid of the sensor\",\n      \"description\":\"UUID of the sensor based on which you want to filter alarms retrieved from the AlienVault USM Anywhere server.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"text\",\n      \"name\":\"alarm_sensor_sources\"\n   }\n]"
                       }
                    },
                    "status":null,
                    "top":"30",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                    "uuid":"6014bcde-0df4-4be4-998c-8637078640be",
                    "id":15681
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Fetch Incidents",
                    "description":null,
                    "arguments":{
                       "name":"Fortinet AlienVaultUSM",
                       "config":"5c13916f-1350-4e50-b51f-1184fb54daaa",
                       "params":{
                          "page":"{{vars.item}}",
                          "size":100,
                          "sort":"Time Created",
                          "status":"{{vars.alarm_status}}",
                          "sort_order":"Ascending",
                          "suppressed":"{{vars.suppressed}}",
                          "rule_intent":"{{vars.rule_intent}}",
                          "rule_method":"{{vars.rule_method}}",
                          "rule_strategy":"{{vars.rule_strategy}}",
                          "priority_label":"{{vars.priority_label}}",
                          "alarm_sensor_sources":"{{vars.alarm_sensor_sources}}",
                          "timestamp_occured_gte":"{{vars.last_pull_time}}",
                          "timestamp_occured_lte":"{{vars.curr_timestamp}}"
                       },
                       "version":"1.0.1",
                       "for_each":{
                          "item":"{{vars.pages_array}}",
                          "parallel":false,
                          "condition":""
                       },
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_alarms",
                       "mock_result":"",
                       "operationTitle":"Get Alarms",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"839",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"6817f866-32ba-4308-bd71-35600fea4459",
                    "id":15704
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Save Result",
                    "description":null,
                    "arguments":{
                       "data":"{{vars.steps.Fetch_Incidents|json_query(\"[].data._embedded.alarms[]\")}}",
                       "event_count":"{{vars.event_count}}",
                       "current_time":"{{vars.curr_timestamp}}",
                       "AlienVaultUSMMacroName":"AlienVaultUSMLastAlertPullTime"
                    },
                    "status":null,
                    "top":"974",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"a6eafb02-241c-48a3-88ff-60255f7c11a9",
                    "id":15678
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Compute Total Pages",
                    "description":null,
                    "arguments":{
                       "__append_pages":"{%set _mp=vars.total_pages%}\n{%for n in range(_mp)%}{{vars.pages_array.append(n+1)}}{%endfor%}"
                    },
                    "status":null,
                    "top":"705",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"b6e985c2-14ed-46be-bd4d-67c28d568e3a",
                    "id":15702
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Get Alarms Count",
                    "description":null,
                    "arguments":{
                       "name":"Fortinet AlienVaultUSM",
                       "config":"5c13916f-1350-4e50-b51f-1184fb54daaa",
                       "params":{
                          "page":1,
                          "size":100,
                          "sort":"Time Created",
                          "status":"{{vars.alarm_status}}",
                          "sort_order":"Ascending",
                          "suppressed":"{{vars.suppressed}}",
                          "rule_intent":"{{vars.rule_intent}}",
                          "rule_method":"{{vars.rule_method}}",
                          "rule_strategy":"{{vars.rule_strategy}}",
                          "priority_label":"{{vars.priority_label}}",
                          "alarm_sensor_sources":"{{vars.alarm_sensor_sources}}",
                          "timestamp_occured_gte":"{{vars.last_pull_time}}",
                          "timestamp_occured_lte":"{{vars.curr_timestamp}}"
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_alarms",
                       "mock_result":"",
                       "operationTitle":"Get Alarms",
                       "step_variables":{
                          "event_count":"{{vars.result.data.page.totalElements}}",
                          "total_pages":"{{vars.result.data.page.totalPages}}"
                       }
                    },
                    "status":null,
                    "top":"570",
                    "left":"125",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"f0da068e-06e4-4969-983f-074bf9110fdf",
                    "id":15701
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Configuration -> Environment Setup",
                    "targetStep":"/api/3/workflow_steps/4b329261-8a0d-4a1a-b98e-9e07aaf62948",
                    "sourceStep":"/api/3/workflow_steps/1bf00642-e024-477a-bf95-b4c7cbf298db",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"1289d7d8-b49f-4503-934b-8f12cb953cf7"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Start -> Configuration",
                    "targetStep":"/api/3/workflow_steps/1bf00642-e024-477a-bf95-b4c7cbf298db",
                    "sourceStep":"/api/3/workflow_steps/6014bcde-0df4-4be4-998c-8637078640be",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"0629f966-a951-4245-aa95-2ff6339a1da9"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Environment Setup -> Set Time Configuration",
                    "targetStep":"/api/3/workflow_steps/04e8bafe-3fe2-432d-a1f2-1be2f820e4b3",
                    "sourceStep":"/api/3/workflow_steps/4b329261-8a0d-4a1a-b98e-9e07aaf62948",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"1e0414a2-b14e-45b6-a869-d4a07e89c6a9"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Set Time Configuration -> Get Alarms Count",
                    "targetStep":"/api/3/workflow_steps/f0da068e-06e4-4969-983f-074bf9110fdf",
                    "sourceStep":"/api/3/workflow_steps/04e8bafe-3fe2-432d-a1f2-1be2f820e4b3",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"0b1bc9ea-4347-4db5-8e72-13784741416e"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Get Alarms Count -> Compute Total Pages",
                    "targetStep":"/api/3/workflow_steps/b6e985c2-14ed-46be-bd4d-67c28d568e3a",
                    "sourceStep":"/api/3/workflow_steps/f0da068e-06e4-4969-983f-074bf9110fdf",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"c3782c14-ca1e-4a57-bf19-14e3d19270dd"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Compute Total Pages -> Fetch Incidents",
                    "targetStep":"/api/3/workflow_steps/6817f866-32ba-4308-bd71-35600fea4459",
                    "sourceStep":"/api/3/workflow_steps/b6e985c2-14ed-46be-bd4d-67c28d568e3a",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"f2259367-2c53-435a-bb3c-3a601233d2b3"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Fetch Incidents -> Save Result",
                    "targetStep":"/api/3/workflow_steps/a6eafb02-241c-48a3-88ff-60255f7c11a9",
                    "sourceStep":"/api/3/workflow_steps/6817f866-32ba-4308-bd71-35600fea4459",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"b0dbae54-913c-4897-99fa-b58f89e363dd"
                 }
              ],
              "priority":null,
              "uuid":"a4c1d5c6-76a8-4a92-ac4e-4a225dbe759e",
              "recordTags":[
                 "dataingestion",
                 "fetch",
                 "alienvault-usm-anywhere"
              ],
              "id":2968,
              "createUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "createDate":1648642383,
              "modifyUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "modifyDate":1648747300,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"AlienVaultUSM > Ingest",
              "aliasName":null,
              "tag":"#alienvault-usm-anywhere #ingest #dataingestion #create",
              "description":"This playbook demonstrate the list incident operation.",
              "isActive":true,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1648745730,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/d38fad7c-d3fb-4ef2-aa80-b1dbf21c0150",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Configuration",
                    "description":null,
                    "arguments":{
                       "event_count":"{{ vars.result.event_count }}",
                       "tenant_name":"{{vars.result.tenant_mapping | default({})}}",
                       "alerts_status_map":"{}",
                       "alerts_severity_map":"{'low': {{'Severity'| picklist('Low') }}, 'medium': {{'Severity'| picklist('Medium') }}, 'high': {{'Severity'| picklist('High') }}}",
                       "incident_source_data":"{{ vars.result.data }}",
                       "AlienVaultUSMMacroName":"{{vars.result.AlienVaultUSMMacroName}}",
                       "alerts_closureReason_map":"{}",
                       "alerts_respSlaStatus_map":"{}",
                       "alerts_escalatedtoincident_map":"{}"
                    },
                    "status":null,
                    "top":"300",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                    "uuid":"4d38e6d4-87d2-4830-a833-62101f0e262f",
                    "id":15699
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Update Last Alert Pull Time",
                    "description":null,
                    "arguments":{
                       "params":{
                          "macro":"{{vars.AlienVaultUSMMacroName}}",
                          "value":"{{vars.steps.List_Incident.current_time}}"
                       },
                       "version":"3.2.0",
                       "connector":"cyops_utilities",
                       "operation":"updatemacro",
                       "operationTitle":"FSR: Update Global Variables",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"570",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                    "uuid":"5e145710-8aa7-4364-9f2c-e77b955c6c55",
                    "id":15695
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"List Incident",
                    "description":null,
                    "arguments":{
                       "arguments":[
                          
                       ],
                       "apply_async":false,
                       "step_variables":[
                          
                       ],
                       "workflowReference":"/api/3/workflows/a4c1d5c6-76a8-4a92-ac4e-4a225dbe759e"
                    },
                    "status":null,
                    "top":"165",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
                    "uuid":"d10c4f67-e966-4b2d-b55b-52f170bd1f64",
                    "id":15697
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Start",
                    "description":null,
                    "arguments":{
                       "route":"e39f427a-307b-42b2-bbd5-96557fcc9da7",
                       "title":"AlienVaultUSM > Ingest",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[
                          
                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.input.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          },
                          "incidents":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":true,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"30",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"d38fad7c-d3fb-4ef2-aa80-b1dbf21c0150",
                    "id":15698
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Create Record",
                    "description":null,
                    "arguments":{
                       "for_each":{
                          "item":"{{vars.incident_source_data}}",
                          "__bulk":true,
                          "parallel":false,
                          "condition":"",
                          "batch_size":100
                       },
                       "resource":{
                          "url":"{{vars.item._links.self.href or None}}",
                          "name":"{{vars.item.rule_strategy}}-{{vars.item.rule_method}}",
                          "domain":"{{vars.item.attributes.domain or None}}",
                          "source":"AlienVaultUSM",
                          "status":{
                             "id":118,
                             "@id":"/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                             "icon":null,
                             "uuid":"7de816ff-7140-4ee5-bd05-93ce22002146",
                             "@type":"Picklist",
                             "color":null,
                             "display":"Open",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                             "itemValue":"Open",
                             "orderIndex":1
                          },
                          "severity":"{{vars.item.priority_label | resolveRange(vars.alerts_severity_map)}}",
                          "sourceId":"{{vars.item.uuid}}",
                          "userName":"{{vars.item.destination_username or None}}",
                          "__replace":"true",
                          "epochTime":"{{vars.item.timestamp_occured}}",
                          "sourcedata":"{{vars.item | toJSON}}",
                          "description":"<div class=\"font-size-16 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\">{{vars.item.audit_reason or 'N/A'}}</h4></div>\n{%if vars.item.highlight_fields|length > 0%}\n{%set _item_data={}%}{%for entry in vars.item.highlight_fields%}{%set _tmp=_item_data.update({entry:vars.item[entry] or 'N/A'})%}{%endfor%}\n{{_item_data | json2html(row_fields=[], template=\"Stylized with row selection\", display=\"Vertical\", styling=false, table_style={})}}{%endif%}",
                          "targetAsset":"{{vars.item.destination_asset_id or None}}",
                          "ackSlaStatus":{
                             "id":308,
                             "@id":"/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                             "icon":null,
                             "uuid":"72979f64-e8b9-4888-a965-957e0ec24818",
                             "@type":"Picklist",
                             "color":"#808080",
                             "display":"Awaiting Action",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                             "itemValue":"Awaiting Action",
                             "orderIndex":2
                          },
                          "computerName":"{{vars.item.destination_asset_id or None}}",
                          "closureReason":{
                             "id":251,
                             "@id":"/api/3/picklists/8590c81e-3307-4645-97f5-c3e1bec4e05a",
                             "icon":null,
                             "uuid":"8590c81e-3307-4645-97f5-c3e1bec4e05a",
                             "@type":"Picklist",
                             "color":null,
                             "display":"Tasks Completed",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                             "itemValue":"Tasks Completed",
                             "orderIndex":0
                          },
                          "destinationIp":"{{vars.item.attributes.destIpAddr or None}}",
                          "mitreattackid":"{{vars.item.rule_attack_id or None}}",
                          "respSlaStatus":{
                             "id":308,
                             "@id":"/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                             "icon":null,
                             "uuid":"72979f64-e8b9-4888-a965-957e0ec24818",
                             "@type":"Picklist",
                             "color":"#808080",
                             "display":"Awaiting Action",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                             "itemValue":"Awaiting Action",
                             "orderIndex":2
                          },
                          "mitreTechnique":"{{vars.item.rule_attack_technique or None}}",
                          "priorityWeight":1,
                          "alertDetectionDate":"{{vars.item.timestamp_received or None}}",
                          "escalatedtoincident":{
                             "id":31,
                             "@id":"/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                             "icon":null,
                             "uuid":"2128a09c-153d-4db3-985d-de6be33deae5",
                             "@type":"Picklist",
                             "color":"#808080",
                             "display":"No",
                             "@context":"/api/3/contexts/Picklist",
                             "listName":"/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                             "itemValue":"No",
                             "orderIndex":1
                          },
                          "alertRemainingAckSLA":0
                       },
                       "_showJson":false,
                       "operation":"Overwrite",
                       "collection":"/api/3/upsert/alerts",
                       "__recommend":[
                          
                       ],
                       "fieldOperation":{
                          "recordTags":"Overwrite"
                       },
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"435",
                    "left":"475",
                    "stepType":"/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
                    "uuid":"fae754d3-f42d-407c-bdb7-1231e552bf3e",
                    "id":15696
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Start -> List Incident",
                    "targetStep":"/api/3/workflow_steps/d10c4f67-e966-4b2d-b55b-52f170bd1f64",
                    "sourceStep":"/api/3/workflow_steps/d38fad7c-d3fb-4ef2-aa80-b1dbf21c0150",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"25c33e5e-0481-425c-ad4e-893499e67d24"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Create Record -> Update Last Alert Pull Time",
                    "targetStep":"/api/3/workflow_steps/5e145710-8aa7-4364-9f2c-e77b955c6c55",
                    "sourceStep":"/api/3/workflow_steps/fae754d3-f42d-407c-bdb7-1231e552bf3e",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"57edefbc-9a83-4855-8b1e-578fc811d03e"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"Config -> Create Alert1",
                    "targetStep":"/api/3/workflow_steps/fae754d3-f42d-407c-bdb7-1231e552bf3e",
                    "sourceStep":"/api/3/workflow_steps/4d38e6d4-87d2-4830-a833-62101f0e262f",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"920266f8-5a4b-486b-a62e-4da0f68dab30"
                 },
                 {
                    "@type":"WorkflowRoute",
                    "name":"List Incident -> Config",
                    "targetStep":"/api/3/workflow_steps/4d38e6d4-87d2-4830-a833-62101f0e262f",
                    "sourceStep":"/api/3/workflow_steps/d10c4f67-e966-4b2d-b55b-52f170bd1f64",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"2c918a9f-e807-4daa-8fd3-0a92872ead7b"
                 }
              ],
              "priority":null,
              "uuid":"aa96e943-bacd-45e7-94c8-168eb06d77b1",
              "recordTags":[
                 "dataingestion",
                 "create",
                 "ingest",
                 "alienvault-usm-anywhere"
              ],
              "id":2971,
              "createUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "createDate":1648642383,
              "modifyUser":"/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
              "modifyDate":1648745730,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"Alarm: Get Alarm Details",
              "aliasName":null,
              "tag":"#Alienvault USM Anywhere",
              "description":"Get Alarm Details",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1625828053,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/6c241d09-54d8-4b00-abc8-961c14391396",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Get Alarm Details",
                    "description":null,
                    "arguments":{
                       "name":"Alienvault USM Anywhere",
                       "config":"52b04e16-3d4d-49ae-b818-ebe435541a51",
                       "params":{
                          "alarmId":"1708bd82-30f3-1a24-d395-4cf5ca213a97"
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_alarm_details",
                       "operationTitle":"Get Alarm Details",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"140",
                    "left":"206",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"29afa40e-daa3-4043-864d-5bcef7ecccf1",
                    "id":7426
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Alerts",
                    "description":null,
                    "arguments":{
                       "route":"8fd2a3c2-32c1-4dcd-a8db-03db138f1b9c",
                       "title":"Alienvault USM Anywhere: Get Alarm Details",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[
                          
                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.request.data.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":false,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"20",
                    "left":"20",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"6c241d09-54d8-4b00-abc8-961c14391396",
                    "id":7427
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Alerts -> Get Alarm Details",
                    "targetStep":"/api/3/workflow_steps/29afa40e-daa3-4043-864d-5bcef7ecccf1",
                    "sourceStep":"/api/3/workflow_steps/6c241d09-54d8-4b00-abc8-961c14391396",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"ad181397-e0fa-4f9c-a247-a1fa42e2ee47"
                 }
              ],
              "priority":null,
              "uuid":"cf1b5d10-7dae-4b8a-8101-5c5a2d8ca7c7",
              "recordTags":[
                 "alienvault-usm-anywhere",
                 "AlienVault"
              ],
              "id":1502,
              "createUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "createDate":1633027730,
              "modifyUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "modifyDate":1633027730,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"Alarm: Add Alarm Label",
              "aliasName":null,
              "tag":"#Alienvault USM Anywhere",
              "description":"Add a label to an alarm",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1625827107,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/4f89c166-fce9-45b6-9fc4-d4a0bf97dbf6",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Start",
                    "description":null,
                    "arguments":{
                       "route":"f1f149af-8078-4119-9408-60fca657db36",
                       "title":"Alienvault USM Anywhere: Add Alarm Label",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[
                          
                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.input.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":true,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"20",
                    "left":"20",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"4f89c166-fce9-45b6-9fc4-d4a0bf97dbf6",
                    "id":7428
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Add Alarm Label",
                    "description":null,
                    "arguments":{
                       "name":"Alienvault USM Anywhere",
                       "config":"3706c9f3-13a8-4d5c-990a-efc2433b213f",
                       "params":{
                          "alarmId":"aa274c77-f573-9903-1db5-230b429af083",
                          "labelId":"2c90c544-9757-4473-adae-c767ddd670e0"
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"add_alarm_label",
                       "operationTitle":"Add Alarm Label",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"137",
                    "left":"211",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"5a4d2a8c-d7fa-46f7-b61a-334060a68787",
                    "id":7429
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Start -> Add Alarm Label",
                    "targetStep":"/api/3/workflow_steps/5a4d2a8c-d7fa-46f7-b61a-334060a68787",
                    "sourceStep":"/api/3/workflow_steps/4f89c166-fce9-45b6-9fc4-d4a0bf97dbf6",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"de554a67-a1e5-47f0-a0b3-a1670d7ad991"
                 }
              ],
              "priority":null,
              "uuid":"e8af1410-79f0-45fa-b692-62cd937e6b1b",
              "recordTags":[
                 "alienvault-usm-anywhere",
                 "AlienVault"
              ],
              "id":1503,
              "createUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "createDate":1633027730,
              "modifyUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "modifyDate":1633027730,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"Event: Get Events",
              "aliasName":null,
              "tag":"#Alienvault USM Anywhere",
              "description":"Get events from USM server",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1625828519,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/d25c838b-add1-4cf0-848d-b6d93f871b89",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Alerts",
                    "description":null,
                    "arguments":{
                       "route":"623cca61-4a8d-424d-a7b5-509f34174f48",
                       "title":"Alienvault USM Anywhere: Get Events",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[
                          
                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.input.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":true,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"20",
                    "left":"20",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"d25c838b-add1-4cf0-848d-b6d93f871b89",
                    "id":7430
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Get Events",
                    "description":null,
                    "arguments":{
                       "name":"Alienvault USM Anywhere",
                       "config":"52b04e16-3d4d-49ae-b818-ebe435541a51",
                       "params":{
                          "page":1,
                          "size":50,
                          "sort":"timestamp_occured",
                          "plugin":"plugin",
                          "eventName":"",
                          "sensorUUID":"308ba880-2518-44bb-9ada-07b158d11713",
                          "sort_order":"",
                          "sourceName":"",
                          "suppressed":false,
                          "accountName":"account",
                          "sourceUsername":"user@email.com",
                          "timestamp_occured_gte":"2018-12-03T05:37:05.850Z",
                          "timestamp_occured_lte":"2018-12-17T05:36:55.794Z"
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_events",
                       "operationTitle":"Get Events",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"193",
                    "left":"203",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"fdcbe273-76f2-47c2-b7be-8cedbce0c271",
                    "id":7431
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Alerts -> Get Events",
                    "targetStep":"/api/3/workflow_steps/fdcbe273-76f2-47c2-b7be-8cedbce0c271",
                    "sourceStep":"/api/3/workflow_steps/d25c838b-add1-4cf0-848d-b6d93f871b89",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"f707b79c-7df3-4e9f-9fb3-8693dd0daee3"
                 }
              ],
              "priority":null,
              "uuid":"f1fae8c5-dee3-403c-afe9-c84ebbe104ac",
              "recordTags":[
                 "alienvault-usm-anywhere",
                 "AlienVault"
              ],
              "id":1504,
              "createUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "createDate":1633027730,
              "modifyUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "modifyDate":1633027730,
              "owners":[
                 
              ],
              "isPrivate":false
           },
           {
              "@type":"Workflow",
              "triggerLimit":null,
              "name":"Event: Get Event Details",
              "aliasName":null,
              "tag":"#Alienvault USM Anywhere",
              "description":"Get Event Details",
              "isActive":false,
              "debug":false,
              "singleRecordExecution":false,
              "remoteExecutableFlag":false,
              "parameters":[
                 
              ],
              "synchronous":false,
              "lastModifyDate":1625828449,
              "collection":"/api/3/workflow_collections/e4de8e4a-9836-49d9-91a1-c67b8a59f367",
              "versions":[
                 
              ],
              "triggerStep":"/api/3/workflow_steps/bfcb9665-d907-477c-9ea1-79b6e4b36738",
              "steps":[
                 {
                    "@type":"WorkflowStep",
                    "name":"Get Event Details",
                    "description":null,
                    "arguments":{
                       "name":"Alienvault USM Anywhere",
                       "config":"52b04e16-3d4d-49ae-b818-ebe435541a51",
                       "params":{
                          "eventId":"93399a50-6c9d-99fb-bb2a-a6bdc7583c3b"
                       },
                       "version":"1.0.1",
                       "connector":"alienvault-usm-anywhere",
                       "operation":"get_event_details",
                       "operationTitle":"Get Event Details",
                       "step_variables":[
                          
                       ]
                    },
                    "status":null,
                    "top":"168",
                    "left":"173",
                    "stepType":"/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
                    "uuid":"37e5c088-9b4e-426b-ac2e-51951ded5071",
                    "id":7432
                 },
                 {
                    "@type":"WorkflowStep",
                    "name":"Alerts",
                    "description":null,
                    "arguments":{
                       "route":"921cabc7-5ce2-41d1-8457-63f46b16ea10",
                       "title":"Alienvault USM Anywhere: Get Event Details",
                       "resources":[
                          "alerts"
                       ],
                       "inputVariables":[
                          
                       ],
                       "step_variables":{
                          "input":{
                             "records":"{{vars.request.data.records}}"
                          }
                       },
                       "displayConditions":{
                          "alerts":{
                             "sort":[
                                
                             ],
                             "limit":30,
                             "logic":"AND",
                             "filters":[
                                
                             ]
                          }
                       },
                       "executeButtonText":"Execute",
                       "noRecordExecution":false,
                       "singleRecordExecution":false
                    },
                    "status":null,
                    "top":"20",
                    "left":"20",
                    "stepType":"/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                    "uuid":"bfcb9665-d907-477c-9ea1-79b6e4b36738",
                    "id":7433
                 }
              ],
              "routes":[
                 {
                    "@type":"WorkflowRoute",
                    "name":"Alerts -> Get Event Details",
                    "targetStep":"/api/3/workflow_steps/37e5c088-9b4e-426b-ac2e-51951ded5071",
                    "sourceStep":"/api/3/workflow_steps/bfcb9665-d907-477c-9ea1-79b6e4b36738",
                    "label":null,
                    "isExecuted":false,
                    "uuid":"b4300979-08f7-4e3e-a930-b673395ff4d0"
                 }
              ],
              "priority":null,
              "uuid":"f3941066-8a87-40c4-a4b9-f47081c278f5",
              "recordTags":[
                 "alienvault-usm-anywhere",
                 "AlienVault"
              ],
              "id":1505,
              "createUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "createDate":1633027730,
              "modifyUser":"/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
              "modifyDate":1633027730,
              "owners":[
                 
              ],
              "isPrivate":false
           }
        ]
     }
  ],
  "exported_tags":[
     "alienvault-usm-anywhere",
     "AlienVault",
     "dataingestion",
     "fetch",
     "create",
     "ingest"
  ]
}